From f5bf4035cf795a35993f1963fcf54ae46cd7250e Mon Sep 17 00:00:00 2001
From: Roman Stratiienko <r.stratiienko@gmail.com>
Date: Thu, 11 May 2023 01:54:11 +0300
Subject: [PATCH] android: Use syslog logger by default

Android syslog implementation will write to the logcat buffer.

Signed-off-by: Roman Stratiienko <r.stratiienko@gmail.com>
---
 src/libcamera/base/log.cpp | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/src/libcamera/base/log.cpp b/src/libcamera/base/log.cpp
index 55fbd7b0..98808601 100644
--- a/src/libcamera/base/log.cpp
+++ b/src/libcamera/base/log.cpp
@@ -603,9 +603,14 @@ Logger::Logger()
  */
 void Logger::parseLogFile()
 {
-	const char *file = utils::secure_getenv("LIBCAMERA_LOG_FILE");
+	char *file = utils::secure_getenv("LIBCAMERA_LOG_FILE");
+
 	if (!file)
+#ifndef __ANDROID__
 		return;
+#else
+		file = "syslog";
+#endif
 
 	if (!strcmp(file, "syslog")) {
 		logSetTarget(LoggingTargetSyslog);
-- 
2.37.2

